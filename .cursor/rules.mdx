# Project Rules (Authoritative)

## 0. Mission
Build a **production-ready, scalable, maintainable web application**.
This project is not experimental.
Clarity, consistency and reuse are mandatory.

If multiple solutions exist: **choose the simplest one**.

---

## 1. Fixed Stack (non-negotiable)

### Framework
- React 18+
- Next.js (App Router)
- TypeScript (`strict: true`)

### UI
- shadcn/ui
- Radix UI primitives
- Tailwind CSS (utility-first)

### Data
- Supabase
- PostgreSQL
- SQL-first
- Row Level Security (RLS)

---

## 2. Golden Rules (always apply)

- Do **not** invent new patterns
- Prefer existing shadcn components
- Extend via **variants**, not new components
- Composition over abstraction
- Explicit code over magic
- Accessibility is mandatory
- Fewer components > more variants

If you feel creative: **stop and reuse a pattern**.

---

## 3. UI & Design Principles

- No Material Design
- No Ant Design
- No Bootstrap
- No visual ideology
- UX semantics before visuals
- Consistency beats originality

UI describes **meaning**, not pixels.

---

## 4. Components

### General
- Always check shadcn/ui first
- No “Base”, “Core” or “Abstract” components
- No deep inheritance hierarchies
- Avoid unnecessary wrappers

### Variants
- Use `variant`, `size`, `intent`, `density`
- Use `cva`
- No conditional class chaos

### Rendering Model
- Server Components by default
- Client Components only when interaction is required

---

## 5. Styling (strict)

- Tailwind utilities only
- No inline styles
- No CSS-in-JS
- No global CSS files
- Tokens via Tailwind config

Allowed:
```tsx
className="flex items-center gap-2 text-sm text-muted-foreground"
```

Forbidden:
```tsx
style={{ marginTop: 12 }}
```

### Exceptions (explicitly allowed)

The project uses shadcn/ui + Tailwind and needs a few pragmatic exceptions to stay consistent with upstream patterns:

- **Global CSS**: `app/globals.css` is allowed **as the single global stylesheet** for Tailwind imports, theme tokens, and base layer styles. Do not add additional global CSS files.
- **Inline styles**: Inline `style={...}` is allowed **only** for setting CSS variables required by shadcn components (e.g. `style={{ "--sidebar-width": ... }}`), and should be avoided elsewhere.

---

## 6. Layout & Responsiveness

- Mobile-first
- Breakpoints via Tailwind only (`sm`, `md`, `lg`)
- No JavaScript for layout logic
- Prefer Flex/Grid
- Use semantic HTML (`main`, `section`, `nav`, `header`)

---

## 7. Accessibility (non-optional)

- Prefer Radix primitives
- Full keyboard navigation
- Visible focus states
- Proper labels for inputs
- Use `aria-*` only when necessary

If unsure: follow Radix documentation.

---

## 8. Forms

- `react-hook-form`
- `zod` as single source of truth
- Server Actions for submit
- Explicit loading, error and success states
- No uncontrolled inputs

Validation errors are **UX**, not edge cases.

---

## 9. Data & Backend

### Principles
- Data logic belongs to the database
- RLS is part of the architecture
- Never trust client state

### Reading
- Via Server Components
- Select only required fields
- No `select *`

### Writing
- Via Server Actions
- Always authorized
- Never bypass RLS

---

## 10. Authentication & Authorization

- Supabase Auth
- Authorization via RLS
- Roles and ownership modeled in DB
- No frontend-only security logic

Frontend checks are **UX only**, never security.

---

## 11. Tables & Lists

- shadcn Table
- Server-side pagination
- Server-side sorting
- Filters explicit and visible
- Destructive actions require confirmation
- Bulk actions clearly marked

Tables are **primary work surfaces**, not decoration.

---

## 12. Error Handling

- No silent failures
- Clear user-facing messages
- No technical stack traces for users
- Errors must suggest a next step

An unexplained error is a **UX bug**.

---

## 13. Performance & Complexity

- Simplicity before optimization
- Server Components first
- Client state only when required
- Avoid global state
- No premature memoization

Measure before optimizing.

---

## 14. Folder Structure (mandatory)

```
/app               → routes
/components/ui     → shadcn components
/components/shared → project-wide components
/lib               → utils, db, auth
```

No creative deviations.

---

## 15. Decision Heuristic (for AI)

When uncertain:
1. Choose the simplest solution
2. Reuse an existing pattern
3. Reduce scope
4. Avoid abstraction
5. Prefer explicit code

---

## 16. Definition of Done (UI)

- Consistent with existing UI
- Responsive
- Keyboard accessible
- Uses existing components
- No dead code
- No unnecessary complexity

---

## 17. Final Rule

> If you notice you are inventing something,  
> stop and reuse an existing pattern.
