---
title: Tooling / Libraries (MVP)
---

## Ziel
Dieses Dokument listet die Tools/Libraries, die wir für den MVP brauchen, und wofür sie eingesetzt werden.

## Frontend (Next.js / React)
### Basis (bereits im Projekt)
- **Next.js / React**: App Router, UI-Routing, Client/Server Components.
- **shadcn/ui**: UI-Komponenten (Tabs, Breadcrumbs, Buttons, etc.).
- **Tailwind CSS**: Styling.

### Editor / Arbeitsfläche (UI-Layer)
- **konva + react-konva**
  - **Wofür**: Canvas-Scenegraph für Arbeitsfläche, Zoom/Pan (Hand-Tool), Rendern von Overlay-Layern (Raster, Rahmen, Pattern, Zahlen).
  - **Warum**: Sehr geeignet für „Raster (z. B. 40×20) + Overlays + Interaktion“.

#### Editor-Verhalten (Illustrator-Style)
Konva ist **kein fertiger Foto-Editor**, sondern ein **2D-Scenegraph** (Stage/Layer/Nodes + Events). Die „Tools“ (Hand, Select, Zoom, Rotate, Crop, …) implementieren wir als eigene Logik darauf.

- **Canvas/Viewport Tools (wirken auf den Workspace, nicht auf das Bild)**
  - **Hand / Pan**: Stage draggable (Viewport verschieben)
  - **Zoom + / -**: Stage scale/position (Zoom um Cursor oder Canvas-Mitte)
  - **Fit to screen**: Stage so einstellen, dass Image in View passt
- **Object Tools (wirken auf Nodes im Canvas)**
  - **Select (Arrow)**: Stage nicht draggable, stattdessen Image-Node auswählbar + draggable (Bild im Canvas bewegen)
  - **Transformer (optional)**: Resize/Rotate Handles für selektierte Nodes
- **Crop (später)**
  - UI: Crop-Rect als Node + Transformer
  - Rendering: entweder nur visuell via clipping oder „apply“ als neuer Export (separater Schritt)

#### Saubere Auslagerung (Technik / Architektur)
Ziel: Die Projekt-Detailseite ist nur „Shell“, der Editor wächst als eigenes Modul.

- **`components/shared/editor/` (UI & Composition)**
  - **`project-editor-header.tsx`**: Header + inline title editing
  - **`canvas-tool-sidebar.tsx`**: Tool rail (Hand/Select/Zoom/Fit/Rotate)
  - **`project-canvas-stage.tsx`**: Konva Stage/Layer renderer (artboard + image)
  - **`artboard-panel.tsx`**: Artboard controls (unit/size + raster effects preset) + persistence
  - **`image-panel.tsx`**: Image size controls (uses artboard unit + dpi)
  - **`index.ts`**: module barrel exports
- **`lib/editor/` (State, Commands, Model)**
  - **Types/Model**: `canvas-model.ts` (viewport/world math)
  - **Units/Conversion**: `units.ts` (mm/cm/pt/px ⇄ px, display snapping helpers)
  - **Hooks**: `use-image-state.ts` (load/save image working state)
  - **Serialize/Persist** (später): Speichern/Laden von Scene/Settings (DB)
 - **`lib/api/` (Client helpers)**
  - **`http.ts`**: typed JSON fetching helper
  - **`project-images.ts`**: typed helpers for master image endpoints

**Prinzipien**
- Editor-State/Commands sind **UI-unabhängig** (testbar, stabil).
- Canvas ist **View** (rendert State; keine Business-Logik).
- API/Storage bleibt separat (Editor konsumiert nur URLs/Metadaten).

### Datenfluss
- **Generation JSON** (Palette + Cells + Settings)
  - **Wofür**: Frontend rendert Overlay aus denselben Daten, die Backend für PDF nutzt.
  - **Spezifikation**: siehe `docs/specs/palette-vektor-generation.mdx`

## Backend (Python, Processing)
### API
- **FastAPI**
  - **Wofür**: HTTP-Endpoints (z. B. `POST /process`, später `POST /export/pdf`).
- **Uvicorn**
  - **Wofür**: ASGI Server für FastAPI.

### Bildverarbeitung
- **Pillow (PIL)**
  - **Wofür**: Bild einlesen, Format-Erkennung, Basis-Resize/Export (CMYK→RGB reicht über Canvas/Decode, ohne ICC-Genauigkeit).
- **NumPy**
  - **Wofür**: Pixel-Arrays, schnelles Rechnen auf Rasterdaten.

### Farbreduktion / Quantisierung
Eine Option wählen (nicht mehrere parallel):
- **scikit-image**
  - **Wofür**: Quantisierung / ggf. Dithering / Hilfsfunktionen.
  - **Alternative**: **OpenCV** (wenn ihr lieber OpenCV-Tooling nutzt).

### PDF (Vektor-Output)
- **ReportLab**
  - **Wofür**: Vektor-PDF generieren (Zellrahmen/Pattern-Linien als Vektoren, Zahlen als Text, Legende als Tabelle/Swatches).

## Optional (später)
- **Supabase**
  - **DB**: Projekte, Metadaten, Generation (Palette+Cells+Settings).
  - **Storage**: Original/Working Images und generierte PDFs.
- **Auth/Rollen**: später (MVP: Editor/owner-only).

